From e1616d2c0ed2af4e84417cbcce68ba0b3609c74c Mon Sep 17 00:00:00 2001
From: Techcable <Techcable@techcable.net>
Date: Mon, 6 Jun 2016 13:36:10 -0600
Subject: [PATCH] Don't send KICK packets while in HANDSHAKE state


diff --git a/proxy/src/main/java/net/md_5/bungee/connection/InitialHandler.java b/proxy/src/main/java/net/md_5/bungee/connection/InitialHandler.java
index c7de8fa4..9a2c94bb 100644
--- a/proxy/src/main/java/net/md_5/bungee/connection/InitialHandler.java
+++ b/proxy/src/main/java/net/md_5/bungee/connection/InitialHandler.java
@@ -552,7 +552,7 @@ public class InitialHandler extends PacketHandler implements PendingConnection
             @Override
             public void run()
             {
-                if ( thisState != State.STATUS && thisState != State.PING )
+                if ( thisState != State.STATUS && thisState != State.PING && thisState != State.HANDSHAKE ) // Waterfall: Don't kick during handshake
                 {
                     unsafe().sendPacket( new Kick( ComponentSerializer.toString( reason ) ) );
                 }
-- 
2.11.0.windows.1

